(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[814],{45380:function(e,t,n){Promise.resolve().then(n.bind(n,55220)),Promise.resolve().then(n.bind(n,4104))},4104:function(e,t,n){"use strict";n.d(t,{DisplayContent:function(){return tT}});var a,o,s,r,i,l,c,d,u,p,m,g=n(27573),h=n(67587),v=n(35756),f=n(64942);let x=()=>{let{resolvedMode:e}=(0,h.F)(),t="dark"===e?v.Z:f.Z;return{codeStyle:{...t,'pre[class*="language-"]':{...t['pre[class*="language-"]'],background:"transparent"},'code[class*="language-"]':{...t['code[class*="language-"]'],background:"transparent"}}}};var b=n(18013),_=n(70354),y=n(32737),w=n(89404),j=n(24467),C=n(10607),k=n(7653);function S(e){let{didCopy:t,size:n,className:a,...o}=e;return(0,g.jsxs)("div",{className:"relative",children:[(0,g.jsx)(w.T,{className:(0,C.Z)(a,"transition-all",t?"opacity-0 scale-50":"opacity-100 scale-100"),...o,size:n}),(0,g.jsx)(j.J,{className:(0,C.Z)(a,"absolute top-0 left-0 transition-all",t?"opacity-100 scale-100":"opacity-0 scale-50"),size:n})]})}var z=n(87033),N=n(5e3),M=n(40950),E=n(45790),R=n(68280),T=n(52820),q=n(41270);let P=(0,k.memo)(e=>{let{node:t,stylesheet:n,useInlineStyles:a,index:o}=e;return(0,R.ZP)({node:t,stylesheet:n,useInlineStyles:a,key:o})},(e,t)=>(0,N.vZ)(e.node,t.node)&&(0,N.vZ)(e.stylesheet,t.stylesheet));P.displayName="Row";let A=e=>{let{rows:t,stylesheet:n,useInlineStyles:a}=e;return t.map((e,t)=>(0,g.jsx)(P,{index:t,node:e,stylesheet:n,useInlineStyles:a},t))},I=[],F=q.z.array(q.z.string()),O={p:e=>(0,g.jsx)("p",{className:"whitespace-pre-wrap break-words",...e}),li:e=>(0,g.jsx)("li",{className:"whitespace-normal break-words",...e}),ul:e=>(0,g.jsx)("ul",{className:"[&:not(:last-child)_ul]:pb-1 [&:not(:last-child)_ol]:pb-1 list-disc space-y-1.5 pl-7",...e}),ol:e=>(0,g.jsx)("ol",{className:"[&:not(:last-child)_ul]:pb-1 [&:not(:last-child)_ol]:pb-1 list-decimal space-y-1.5 pl-7",...e}),code:e=>{var t;let{inline:n,className:a,children:o,flagShowCodeHeader:s=!0}=e,r=/language-(\w+)/.exec(a||""),i=(null==r?void 0:null===(t=r[1])||void 0===t?void 0:t.toLowerCase())||"",l=String(o).trimEnd(),{didCopy:c,copyToClipboard:d}=function(){let[e,t]=(0,k.useState)(!1),[n,a]=(0,k.useState)(void 0);return{didCopy:e,copyToClipboard:(0,k.useCallback)(async e=>{let o,s;let r=()=>{t(!0),a(setTimeout(()=>t(!1),2e3))};if(n&&clearTimeout(n),"string"==typeof e)o=e.trim();else if(e&&"object"==typeof e)o=e.text.trim(),s=e.html;else throw Error("Invalid clipboard input; no plain text provided");try{if(s)try{await navigator.clipboard.write([new ClipboardItem({"text/plain":new Blob([o],{type:"text/plain"}),"text/html":new Blob([s],{type:"text/html"})})]),r();return}catch(e){try{let e=new ClipboardEvent("copy",{bubbles:!0,cancelable:!0}),t=new DataTransfer;if(t.setData("text/plain",o),t.setData("text/html",s),Object.defineProperty(e,"clipboardData",{value:t,writable:!1}),document.dispatchEvent(e),e.defaultPrevented){r();return}}catch(e){}}await navigator.clipboard.writeText(o),r()}catch(e){console.error("Clipboard copy failed:",e)}},[n])}}(),{codeStyle:u}=x(),p=(0,M.Z)(),m=(0,z.Zr)("claude_code_spotlight_code_viewed_signal","languages",I,F),[,h]=(0,b.R)("claude-code-view-timestamp",null);return(0,k.useEffect)(()=>{!n&&i&&m.includes(i)&&h(Date.now())},[]),n?(null==a?void 0:a.includes("math"))?(0,g.jsx)("span",{className:a,children:o}):(0,g.jsx)("code",{className:(0,C.Z)("bg-text-200/5 border border-0.5 border-border-300 text-danger-000 whitespace-pre-wrap rounded-[0.4rem] px-1 py-px text-[0.9rem]",a),children:o}):(0,g.jsxs)("div",{className:"relative group/copy rounded-lg",children:[!0===s?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("div",{className:"sticky opacity-0 group-hover/copy:opacity-100 top-2 py-2 h-12 w-0 float-right",children:(0,g.jsx)("div",{className:"absolute right-0 h-8 px-2 items-center inline-flex",children:(0,g.jsx)(y.u,{side:"bottom",disableHoverableContent:!0,delayDuration:0,tooltipContent:(0,g.jsx)(E.Z,{defaultMessage:"Copy",id:"4l6vz1/eZ5"}),children:(0,g.jsx)(_.z,{"aria-label":p.formatMessage({defaultMessage:"Copy to clipboard",id:"aCdAsIsVv0"}),variant:"ghost",size:"icon_sm",className:"backdrop-blur-md",onClick:()=>{d(l)},children:(0,g.jsx)(S,{didCopy:c,size:14})})})})}),r&&(0,g.jsx)("div",{className:"text-text-500 text-xs p-3.5 pb-0",children:r[1]})]}):null,(0,g.jsx)("div",{className:(0,C.Z)(!s&&"bg-bg-000/50 border-0.5 border-border-400 rounded-lg"),children:(0,g.jsx)(T.Z,{className:"code-block__code !my-0 !rounded-lg !text-sm !leading-relaxed",language:r?r[1]:"",style:u,renderer:A,wrapLongLines:!r,children:l})})]})}};var L=n(56683);n(94006),(a=l||(l={})).Text="text/plain",a.Markdown="text/markdown",a.Html="text/html",a.Code="application/vnd.ant.code",a.Svg="image/svg+xml",a.Mermaid="application/vnd.ant.mermaid",a.React="application/vnd.ant.react",(c||(c={})).Repl="application/vnd.ant.repl";let D=q.z.string().nullish().transform(e=>null!=e?e:void 0);q.z.object({version_uuid:D,command:q.z.enum(["create","update","rewrite"]).optional().catch(void 0),id:D,title:D,type:q.z.nativeEnum(l).optional().catch(void 0),language:D,content:D,old_str:D,new_str:D,md_citations:q.z.unknown()});let Z="antArtifact",H="<".concat(Z,"(?:\\s+([^>]*)>|(?!>)\\S*)"),G="</".concat(Z,">");RegExp("".concat(H,"([\\s\\S]*?)(?:").concat(G,"|$)"),"g"),RegExp("".concat(H,"[\\s\\S]*?(?:").concat(G,"|$)"),"g");let B="ANTARTIFACTLINK",U="antThinking",$="<".concat(U,">");RegExp("".concat($,"[\\s\\S]*?(?:</").concat(U,">|$)"),"g");var V=n(57895);let W=RegExp("<".concat(B,"\\s+(.*?)\\s*\\/>"),"g"),K=()=>e=>{(0,V.Vn)(e,"html",(e,t,n)=>{let a=e.value.match(W);if(a){let e=a.map(e=>{let{id:t,type:n,title:a,language:o,isClosed:s}=function(e){var t;let n=e.match(/identifier="([^"]*)"/),a=n?n[1]:"",o=e.match(/type="([^"]*)"/),s=o?(t=o[1],Object.values(l).includes(t)?t:"text/plain"):"text/plain",r=e.match(/title="([^"]*)"/),i=r?r[1]:"Untitled artifact",c=e.match(/language="([^"]*)"/),d=c?c[1]:void 0,u=e.match(/isClosed="(true|false)"/);return{id:a,type:s,title:i,language:d,isClosed:u?"true"===u[1]:void 0}}(e.replace("<".concat(B," "),"").replace(/\s*\/>/,"").trim()),r={id:t,title:a,type:n,isClosed:s};return o&&(r.language=o),{type:"artifactComponent",data:{hName:"artifactComponent",hProperties:r}}});n.children.splice(t,1,...e)}})};var J=n(45144);let Q="antCitation",Y=q.z.object({citations:q.z.string()}),X=e=>{let t={};return e.forEach(e=>{let n=e.end_index;t[n]||(t[n]=[]),t[n].push(e)}),Object.values(t).sort((e,t)=>t[0].end_index-e[0].end_index)},ee=(e,t)=>{let n=t;for(let t of X(e)){let e=t[0].end_index;if(e>n.length)continue;let a=[...n].slice(0,e).join(""),o=[...n].slice(e).join(""),s=t.length?function(e){let{tagName:t,inlineContent:n,attributes:a}=e,o=a?"{"+Object.entries(a).map(e=>{let[t,n]=e;return"".concat(t,'="').concat(n,'"')}).join(" ")+"}":"";return":".concat(t,"[").concat(n,"]").concat(o)}({tagName:Q,inlineContent:"",attributes:{citations:t.map(e=>e.uuid).join(",")}}):"",r="";a.endsWith("```")?r="\n":a&&!a.match(/\s$/)&&(r=" "),n=a+r+s+o}return n},et=function(e,t){let n=n=>{(0,V.Vn)(n,void 0,n=>{if(("textDirective"===n.type||"leafDirective"===n.type||"containerDirective"===n.type)&&n.name===e){let o=t(n.attributes);if(n.data={hName:e,hProperties:o},"containerDirective"===n.type&&n.children){let e=[...n.children];for(;e.length;){let t=e.shift();if(t){var a;t.data={...t.data,hProperties:{...(null===(a=t.data)||void 0===a?void 0:a.hProperties)||null,...o}},"children"in t&&e.push(...t.children)}}}}})};return()=>n}(Q,e=>{try{return{citationUuids:Y.parse(e).citations.split(",")}}catch(e){return(0,J.Tb)(e),{citationUuids:[]}}}),en=()=>e=>{(0,V.Vn)(e,"list",e=>{e.spread=!1}),(0,V.Vn)(e,"listItem",e=>{e.spread=!1})};var ea=n(87376).lW;function eo(){return function(e,t){let n=ea.isBuffer(t.value)?t.value.toString("utf8"):"string"==typeof t.value?t.value:String(t.value);(0,V.Vn)(e,(e,t,a)=>{if(void 0===t||void 0===a||void 0===e.children||0===e.children.length)return;let o=!1,s=[],r=e.children.some(e=>"emphasis"===e.type),i=e.children[0].position,l=e.children[e.children.length-1].position;if(r&&i&&l){let[e,t]=ei(n.slice(i.start.offset,l.end.offset));e&&(o=!0,s.push(...t))}else for(let t of e.children)if("text"===t.type){let[e,a]=ei(t.position?n.slice(t.position.start.offset,t.position.end.offset):t.value);e?(o=!0,s.push(...a)):s.push(t)}else s.push(t);if(o){if(s.some(e=>"math"===e.type)){let e=function(e){let t=[],n=[],a=()=>{let e={type:"paragraph",children:t};n.push(e)};for(let o of e)"math"===o.type?(t.length>0&&(a(),t=[]),n.push(o)):t.push(o);return t.length>0&&(a(),t=[]),n}(s);a.children.splice(t,1,...e)}else e.children=s}})}}let es=/^\s*\$\$/,er=/\$\$\s*$/;function ei(e){let t=!1,n=[],a=e.split("\n"),o=!1,s=[];for(let e of a){if(es.test(e)&&er.test(e)&&e.trim().length>4){n.push({type:"math",meta:null,value:e.slice(2,-2),data:{hName:"div",hProperties:{className:["math","math-display"]},hChildren:[{type:"text",value:e.slice(2,-2)}]}}),t=!0;continue}if(!o&&es.test(e)){o=!0;continue}if(o&&es.test(e)){if(o=!1,s){let e=s.join("\n");n.push({type:"math",meta:null,value:e,data:{hName:"div",hProperties:{className:["math","math-display"]},hChildren:[{type:"text",value:e}]}}),t=!0,s=[]}continue}if(o){s.push(e);continue}for(let a=0;a<e.length;a++){let o=function(e,t){let n=!1;do{let a=(n=(t=e.indexOf("$",t))>-1&&function(e,t){let n=!el(e,t-1,"$"),a=!el(e,t+1," "),o=!el(e,t+1,"$");return!ec(e,t)&&n&&a&&o}(e,t))?function(e,t){let n=function(e,t){if(t<=0)return t;let n=e.lastIndexOf(" ",t);return n>-1?n+1:0}(e,t),a=/^(\$\w+!?)?\$?[A-Z]+\$?[0-9]+(:(\$\w+!?)?\$?[A-Z]+\$?[0-9]+)?/g.exec(e.slice(n)),o=a?n+a[0].length-1:-1;return o>-1&&el(e,n,"$")&&el(e,o+1,"$")?-1:o}(e,t):-1;a>-1&&a>t?(n=!1,t=a+1):!n&&t>-1&&(t+=1)}while(t>-1&&!n);return t}(e,a),s=o>-1?function(e,t){let n=!1;do(n=(t=e.indexOf("$",t))>-1&&function(e,t){var n;let a=!el(e,t-1," "),o=(n=t+1)<0||n>=e.length||!(e[n]>="0")||!(e[n]<="9");return!ec(e,t)&&a&&o}(e,t))||!(t>-1)||(t+=1);while(t>-1&&!n);return t}(e,o+1):-1;if(o>-1&&s>-1){o>a&&n.push({type:"text",value:e.substring(a,o)});let r=e.substring(o+1,s);n.push({type:"inlineMath",value:r,data:{hName:"span",hProperties:{className:["math","math-inline"]},hChildren:[{type:"text",value:r+"\n"}]}}),a=s,t=!0}else{a<e.length&&n.push({type:"text",value:e.substring(a)+"\n"});break}}}return[t,n]}function el(e,t,n){return!(t<0)&&!(t>=e.length)&&e[t]===n}function ec(e,t){return el(e,t-1,"\\")&&!ec(e,t-1)}let ed=()=>{let[e,t]=(0,k.useState)({remarkMath:void 0,rehypeKatex:void 0,inHouseLatexPlugin:eo});return(0,k.useEffect)(()=>{(async()=>{let[e,a]=await Promise.all([n.e(171).then(n.bind(n,82171)),Promise.all([n.e(287),n.e(982)]).then(n.bind(n,82982))]);t({remarkMath:e.default,rehypeKatex:a.default,inHouseLatexPlugin:eo})})()},[]),e},eu=(0,k.createContext)(null),ep=()=>{let e=(0,k.useContext)(eu);return void 0===e?null:e};var em=n(9788);let eg=e=>{let{children:t}=e;return(0,g.jsx)("span",{className:"bg-text-400 text-center text-always-white/0 bg-gradient-to-r bg-[length:400%_100%] from-text-400 from-30% via-always-white/70 to-text-400 to-80% bg-clip-text bg-no-repeat animate-[shimmertext_1.5s_infinite]",children:t})},eh=()=>!0;var ev=n(75502),ef=n(38148),ex=n(72229),eb=n(95380),e_=n(69389),ey=n(19541);n(30947),n(42286);var ew=n(8571);n(40287);var ej=n(53500);n(6385);var eC=n(35919),ek=n.n(eC),eS=n(95407);let ez=(0,k.createContext)({showConsentBanner:!1,openConsentBanner:ek(),preferences:eS.iw,savePreferences:ek()});var eN=n(51191);let eM=()=>{let{segmentKey:e,segmentCdnHost:t,segmentApiHost:n}=(0,ew.m)(),{value:a}=(0,z.FL)("requires_explicit_consent"),o=(0,k.useCallback)(()=>{ej.u.reset()},[]);return{analytics:ej.u.loadIfNecessary({segmentKey:e,segmentCdnHost:t,segmentApiHost:n,requiresExplicitConsent:a}),reset:o}},eE={snippets_command_used:{version:1},file_upload_too_large:{version:1},sse_interrupted:{version:1},snippets_suggestion_selected:{version:1},payment_modal_open:{version:1},pro_waitlist_requested:{version:1},payment_state_poll_for_invoice:{version:1},payment_state_poll_for_payment:{version:1},payment_state_poll_for_capability:{version:1},payment_state_payment_requires_confirmation:{version:1},payment_state_payment_failed:{version:1},payment_state_success:{version:1},payment_state_timed_out:{version:1},"onboarding.phone_verification.start":{version:1},"onboarding.phone_verification.sent_code":{version:1},"onboarding.phone_verification.invalid_code":{version:1},"onboarding.phone_verification.verified_code":{version:1},"onboarding.age_verification.start":{version:1},"onboarding.age_verification.complete":{version:1},"onboarding.name_input.started":{version:1},"onboarding.name_input.finished":{version:1},"onboarding.acceptable_use.started":{version:1},"onboarding.acceptable_use.finished":{version:1},"onboarding.disclaimers.started":{version:1},"onboarding.disclaimers.finished":{version:1},"onboarding.started":{version:1},"onboarding.completed":{version:1},"extended_onboarding.started":{version:1},"extended_onboarding.disclaimer.completed":{version:1},"extended_onboarding.name_input.completed":{version:1},"extended_onboarding.work_function.completed":{version:1},"extended_onboarding.drive_integration.started":{version:1},"extended_onboarding.drive_integration.skipped":{version:1},"extended_onboarding.drive_integration.completed":{version:1},"extended_onboarding.gmail_integration.started":{version:1},"extended_onboarding.gmail_integration.skipped":{version:1},"extended_onboarding.gmail_integration.completed":{version:1},"extended_onboarding.gcal_integration.started":{version:1},"extended_onboarding.gcal_integration.skipped":{version:1},"extended_onboarding.gcal_integration.completed":{version:1},"extended_onboarding.topics.completed":{version:1},"extended_onboarding.example_prompts.completed":{version:1},"extended_onboarding.completed":{version:1},"pro_subscription.upgraded_to_annual":{version:1},"pro_subscription.upgraded_to_max":{version:1},"chat.conversation.first_conversation_created":{version:1},"chat.conversation.too_long_prompt:loaded":{version:1},"chat.conversation.too_long_prompt:accepted":{version:1},"chat.conversation.too_long_prompt:dismissed":{version:1},"chat.conversation.too_long_prompt_warning:loaded":{version:1},"chat.conversation.too_long_prompt_warning:accepted":{version:1},"chat.conversation.too_long_prompt_warning:dismissed":{version:1},"chat.share.button.clicked":{version:1},"chat.share.modal.share_button.clicked":{version:1},"chat.share.modal.unshare_button.clicked":{version:1},"chat.share.open_link.clicked":{version:1},"chat.share.copy_link.clicked":{version:1},"ts.eu_election_banner.shown":{version:1,data_team_tag:"ts"},"ts.banner.shown":{version:1,data_team_tag:"ts"},"billing.credit_card.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.completed":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.contact_sales.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.payment_info.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.setup_billing.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire.submitted":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.ts_questionnaire_manual.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.loaded":{version:1,data_team_tag:"billing_funnel"},"billing.upgrade.select_plan.completed":{version:1,data_team_tag:"billing_funnel"},"console.feedback.opened":{version:1},"console.feedback.submitted":{version:1},"evals.revision.created":{version:1},"evals.show_prompt_preview.toggled":{version:1},"evals.show_golden_answers.toggled":{version:1},"evals.run_all.submitted":{version:1},"evals.run_all.stopped":{version:1},"evals.test_case.run.submitted":{version:1},"evals.test_case.run.completed":{version:1},"evals.test_case.run.failed":{version:1},"evals.test_case.create.submitted":{version:1},"evals.test_case.delete.submitted":{version:1},"evals.select_revision.clicked":{version:1},"evals.test_case.update_rating.submitted":{version:1},"evals.test_case.import.show_modal.clicked":{version:1},"evals.test_case.import.browse.clicked":{version:1},"evals.test_case.import.success":{version:1},"evals.comparison.add_button.clicked":{version:1},"evals.comparison.remove_button.clicked":{version:1},"evals.comparison.other_revision.selected":{version:1},"test_case_generator.generate.started":{version:1},"test_case_generator.edit_logic.clicked":{version:1},"metaprompter.modal.loaded":{version:2},"metaprompter.example.selected":{version:1},"metaprompter.generate.started":{version:1},"metaprompter.generate.stop.attempted":{version:1},"metaprompter.generate.finished":{version:1},"metaprompter.start_editing.clicked":{version:1},"onboarding.invite_accept_page.invite_accept.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.invite_reject.submitted":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.invite_accept_page.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.loaded":{version:1,data_team_tag:"onboarding_funnel"},"onboarding.organization_create.submitted":{version:1,data_team_tag:"onboarding_funnel"},"workbench.prompt.new":{version:1},"workbench.completion.started":{version:2},"workbench.completion.finished":{version:2},"workbench.completion_stream.started":{version:1},"workbench.completion_stream.finished":{version:1},"workbench.tab_selection.clicked":{version:1},"workbench.variables_pane.loaded":{version:1},"workbench.examples.pane.loaded":{version:1},"workbench.examples.example.added":{version:2},"workbench.examples.example.deleted":{version:1},"workbench.examples.converted_to_raw_text":{version:1},"workbench.code_modal.opened":{version:1},"workbench.code_modal.code_copied":{version:1},"claudeai.projects.list_view.switched":{version:1},"claudeai.artifacts.execution.error":{version:1},"claudeai.conversation.suggestion.applied":{version:1},"claudeai.conversation.recent.opened":{version:1},"claudeai.projects.activity.shared_conversation.opened":{version:1},"claudeai.projects.project_starter.clicked":{version:1},"claudeai.projects.chat_starter.clicked":{version:1},"claudeai.conversation.artifact.vscode_exported":{version:1},"claudeai.settings.preview_feature.toggled":{version:1},"claudeai.settings.preview_feature.opened":{version:1},"claudeai.support.opened":{version:1},"claudeai.get_help.clicked":{version:1},"claudeai.conversation.feedback.sent":{version:1},"claudeai.conversation.setting.toggled":{version:1},"claudeai.thinking_cell.clicked":{version:1},"ccos.chatsuggestion.clicked":{version:1},"ccos.chatsuggestions.loaded":{version:1},"ccos.chatsuggestions.feedback":{version:1},"styles.selector.clicked":{version:1},"styles.modal":{version:1},"styles.nux.create_clicked":{version:1},"styles.custom.create_clicked":{version:1},"styles.custom.describe_clicked":{version:1},"styles.custom.describe_selected":{version:1},"styles.selected":{version:1},"artifact.feedback.sentiment":{version:1},"artifact.feedback.note":{version:1},"artifact.share_button_clicked":{version:1},"artifact.publish_button_clicked":{version:1},"artifact.share.modal.share_button_clicked":{version:1},"artifact.publish.modal.publish_button_clicked":{version:1},"mcp.servers.listed":{version:1},"mcp.servers.connected":{version:1},"mcp.resources.listed":{version:1},"mcp.resources.read":{version:1},"mcp.prompts.listed":{version:1},"mcp.prompts.used":{version:1},"mcp.tools.listed":{version:1},"mcp.tools.called":{version:1},"mcp.sampling.requested":{version:1},"harmony.file.saved":{version:1},"harmony.suggestion.accepted":{version:1},"harmony.suggestion.rejected":{version:1},"hfi.comparative_model.selected":{version:1},"hfi.comparative_model.selection_cleared":{version:1},"hfi.comparative_model.streaming.started":{version:1},"hfi.comparative_model.streaming.finished":{version:1},"hfi.comparative_model.feedback_bar.switch_response.clicked":{version:1},"hfi.comparative_model.feedback_bar.prefer_response.clicked":{version:1},"apps.download_button_clicked":{version:1},"apps.nudge_banner_shown":{version:1},"apps.nudge_banner_clicked":{version:1},"apps.harmony_directory_synced":{version:1},"console.onboarding.name_and_legal.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.name_and_legal.submitted":{version:1,data_team_tag:"onboarding_funnel"},"tengu.waitlist.update":{version:1},"tengu.waitlist.details":{version:1},"oauth.authorize.approved":{version:1},"oauth.authorize.denied":{version:1},"oauth.authorize.success":{version:1},"oauth.authorize.failure":{version:1},"console.onboarding.account_type.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.account_type.individual_selected":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.account_type.organization_selected":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.organization_details.loaded":{version:1,data_team_tag:"onboarding_funnel"},"console.onboarding.organization_details.submitted":{version:1,data_team_tag:"onboarding_funnel"},"login.account.created":{version:1},"login.email.sending_magic_link":{version:1},"login.email.magic_link_sent":{version:1},"login.email.magic_link_send_error":{version:1},"login.email.verifying_magic_link":{version:1},"login.email.magic_link_success":{version:1},"login.email.magic_link_verification_error":{version:1},"login.email.sso_initiated":{version:1},"login.email.sso_success":{version:1},"login.email.sso_verifying_callback":{version:1},"login.email.sso_verification_error":{version:1},"login.email.verifying_code":{version:1},"login.email.code_verification_error":{version:1},"login.email.finished":{version:1},"login.google.started":{version:1},"login.google.error":{version:1},"login.google.verifying":{version:1},"login.google.verification_error":{version:1},"login.google.finished":{version:1},"landing.section.features.viewed":{version:1},"landing.section.pricing.viewed":{version:1},"spotlight.shown":{version:1},"spotlight.dismissed":{version:1},"spotlight.action_clicked":{version:1},"claudeai.conversation.citation_clicked":{version:1},"claudeai.in_chat_upsell.connect_gdrive.start":{version:1},"claudeai.in_chat_upsell.dismiss":{version:1},"claudeai.cardamom_prompts.category_displayed":{version:1},"claudeai.cardamom_prompts.prompt_displayed":{version:1},"claudeai.cardamom_prompts.prompt_used":{version:1},"artifactinlinefeedback.selection.clicked":{version:1}},eR=["onboarding.started","onboarding.completed","chat.conversation.first_conversation_created","payment_state_success"];n(68571),(o=d||(d={})).GITHUB="github",o.GDRIVE="gdrive",o.OUTLINE="outlin",o.SALESFORCE="sfdc",o.GMAIL="gmail",o.GCAL="gcal",o.SLACK="slack",o.ASANA="asana",(s=u||(u={})).CREATED="created",s.PENDING="pending",s.FAILED="failed",s.UPDATING="updating",s.UPDATE_FAILED="update_failed",s.READY="ready",s.UNAUTHENTICATED="unauthenticated",s.ACCESS_DENIED="access_denied",s.DISABLED="disabled",n(68571),(r=p||(p={})).DOCS="docs",r.SHEETS="sheets",r.SLIDES="slides";let eT=e=>{let{size:t,className:n,variant:a}=e;return"docs"===a?(0,g.jsx)(eq,{size:t,className:n}):(0,g.jsxs)("svg",{width:t,height:t,viewBox:"0 0 87.3 78",xmlns:"http://www.w3.org/2000/svg",className:n,children:[(0,g.jsx)("path",{d:"m6.6 66.85 3.85 6.65c.8 1.4 1.95 2.5 3.3 3.3l13.75-23.8h-27.5c0 1.55.4 3.1 1.2 4.5z",fill:"#0066da"}),(0,g.jsx)("path",{d:"m43.65 25-13.75-23.8c-1.35.8-2.5 1.9-3.3 3.3l-25.4 44a9.06 9.06 0 0 0 -1.2 4.5h27.5z",fill:"#00ac47"}),(0,g.jsx)("path",{d:"m73.55 76.8c1.35-.8 2.5-1.9 3.3-3.3l1.6-2.75 7.65-13.25c.8-1.4 1.2-2.95 1.2-4.5h-27.502l5.852 11.5z",fill:"#ea4335"}),(0,g.jsx)("path",{d:"m43.65 25 13.75-23.8c-1.35-.8-2.9-1.2-4.5-1.2h-18.5c-1.6 0-3.15.45-4.5 1.2z",fill:"#00832d"}),(0,g.jsx)("path",{d:"m59.8 53h-32.3l-13.75 23.8c1.35.8 2.9 1.2 4.5 1.2h50.8c1.6 0 3.15-.45 4.5-1.2z",fill:"#2684fc"}),(0,g.jsx)("path",{d:"m73.4 26.5-12.7-22c-.8-1.4-1.95-2.5-3.3-3.3l-13.75 23.8 16.15 28h27.45c0-1.55-.4-3.1-1.2-4.5z",fill:"#ffba00"})]})},eq=e=>{let{size:t}=e;return(0,g.jsxs)("svg",{width:t,height:t,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 88",children:[(0,g.jsx)("path",{fill:"#3086F6",d:"M58,88H6c-3.3,0-6-2.7-6-6V6c0-3.3,2.7-6,6-6h36l22,22v60C64,85.3,61.3,88,58,88z"}),(0,g.jsx)("path",{fill:"#0C67D6",d:"M42,0l22,22H42V0z"}),(0,g.jsx)("path",{fill:"#FDFFFF",d:"M50,39H14v-5h36V39z M50,46H14v5h36V46z M40,58H14v5h26V58z"})]})};var eP=n(50294);let eA=e=>{let{src:t,fallbackSrc:n,fallbackSvg:a,fadeInOnLoad:o=!1,onLoad:s,alt:r,...i}=e,[l,c]=(0,k.useState)(!1),[d,u]=(0,k.useState)(t),[p,m]=(0,k.useState)(!1);return p&&a?a:(0,g.jsx)(eP.default,{...i,alt:r,src:d,onError:()=>{n?u(n):a&&m(!0)},onLoad:e=>{c(!0),s&&s(e)},className:(0,C.Z)("transition duration-400",l?"opacity-1":o&&"opacity-0 blur-sm")})};var eI=n(15686),eF=n(19984);let eO={highlightedCitation:null,setHighlightedCitation:ek()},eL=(0,k.createContext)(eO);function eD(e){let{children:t,blockCitations:n}=e,[a,o]=(0,k.useState)(null);return(0,g.jsx)(eL.Provider,{value:{highlightedCitation:a,setHighlightedCitation:o,blockCitations:n},children:t})}var eZ=n(50236);let eH=e=>{let t,{url:n,fadeInOnLoad:a,shouldFillBackground:o,size:s=12,fallbackSvg:r,...i}=e,[l,c]=(0,k.useState)(""),d=r||(0,g.jsx)(eZ.T,{size:s+2,className:"text-text-500"});if(!n)return d;if((n.startsWith("https://www.google.com/s2/favicons")||n.startsWith("https://www.gstatic.com"))&&(t=n),!t)try{let e=new URL(n).hostname;t="https://www.google.com/s2/favicons?domain=".concat(e,"&sz=32")}catch(e){return d}let u=(0,g.jsx)(eA,{...i,style:{maxWidth:s,maxHeight:s},className:"object-contain",width:s,height:s,src:t,alt:"favicon",fallbackSvg:d,fadeInOnLoad:a,onLoad:o?e=>c(function(e){try{if(eG&&eB||((eG=document.createElement("canvas")).width=1,eG.height=1,eB=eG.getContext("2d")),!eB)return"";eB.clearRect(0,0,1,1),eB.drawImage(e,0,0,1,1,0,0,1,1);let t=eB.getImageData(0,0,1,1).data;if(t[3]<10)return"transparent";return"rgb(".concat(t[0],", ").concat(t[1],", ").concat(t[2],")")}catch(e){return"transparent"}}(e.currentTarget)):void 0});return o?(0,g.jsx)("div",{className:(0,C.Z)(o&&"flex items-center justify-center w-full h-full transition-colors"),style:{backgroundColor:l},children:u}):u},eG=null,eB=null,eU=window.self!==window.top?()=>({track:()=>Promise.resolve()}):()=>{let{analytics:e}=eM(),{preferences:t}=(0,k.useContext)(ez),{value:n}=(0,z.FL)("log_segment_events"),{value:a}=(0,z.FL)("claude_ai_segment_enabled"),{value:o}=(0,z.FL)("send_email_to_segment"),{account:s,activeOrganization:r,isLoading:i}=(0,eN.t)(),l=(0,ew.Z)(),c=(0,k.useCallback)((c,d)=>{var u,p,m,g;if(i)return;let{event_key:h,...v}=c,f={account_uuid:null!==(m=null==d?void 0:d.uuid)&&void 0!==m?m:null==s?void 0:s.uuid,organization_uuid:null==r?void 0:r.uuid,billing_type:null==r?void 0:r.billing_type,surface:l?"claude-ai":"console",...eE[h],...v},x=eR.includes(h),b={context:{traits:{email:o?null!==(g=null==d?void 0:d.email_address)&&void 0!==g?g:null==s?void 0:s.email_address:null,userAgent:null===(p=window)||void 0===p?void 0:null===(u=p.navigator)||void 0===u?void 0:u.userAgent}},integrations:{"Facebook Pixel":x}};if(n&&console.log("[Segment Event] ".concat(h),f,b),e&&a&&(l||s)&&(s||t.analytics))return e.track(h,f,b)},[e,s,r,l,i,n,a,o,t.analytics]);return(0,k.useMemo)(()=>({track:c}),[c])};function e$(e){let{isStreaming:t,citationUuids:n,messageUuid:a}=e,[o,s]=(0,k.useState)(!1),r=(0,M.Z)(),{blockCitations:i}=(0,k.useContext)(eL),l=n.map(e=>null==i?void 0:i.find(t=>t.uuid===e)).filter(e=>!!e),c=eh(),d=e=>{switch(e.metadata.type){case"webpage_metadata":var t;return null!==(t=e.metadata.site_name)&&void 0!==t?t:r.formatMessage({defaultMessage:"Untitled",id:"3kbIhS7KZS"});case"google_doc_metadata":return r.formatMessage({defaultMessage:"Google Doc",id:"7qYF66c9/s"});default:return e.title}},u=eU(),p=(0,k.useCallback)(e=>{let t,n;if("google_doc_metadata"===e.metadata.type)t="drive_search",n="";else if("webpage_metadata"===e.metadata.type)t="web_search",n=e.metadata.site_domain;else{var o;t=null!==(o=e.origin_tool_name)&&void 0!==o?o:e.metadata.source,n=""}u.track({event_key:"claudeai.conversation.citation_clicked",messageUuid:a,citationSourceTool:t,webDomainName:n})},[u,a]);if(!l.length||!c)return null;if(l.length>=3){let e=l[0];return(0,g.jsx)(y.u,{tooltipContent:(0,g.jsx)(eW,{citations:l,handleClick:p}),className:"!w-[337px]",open:!t&&o,onOpenChange:()=>s(e=>!e),contentStyle:"citation",side:"top",delayDuration:0,children:(0,g.jsx)("span",{className:"inline-flex",children:(0,g.jsx)(eV,{isStreaming:t,tagText:"".concat(d(e)," + ").concat(l.length-1),url:e.url,handleClick:()=>p(e)})})})}return l.map((e,n)=>(0,g.jsxs)(k.Fragment,{children:[n>0&&(0,g.jsx)("span",{className:"inline-flex w-1"}),(0,g.jsx)(y.u,{tooltipContent:(0,g.jsx)(eK,{citation:e,handleClick:p}),className:"!max-w-[310px]",open:!t&&void 0,contentStyle:"citation",side:"top",delayDuration:0,children:(0,g.jsx)("span",{className:"inline-flex",children:(0,g.jsx)(eV,{tagText:d(e),url:e.url,isStreaming:t,handleClick:()=>p(e)})})})]},e.uuid))}let eV=e=>{let{tagText:t,url:n,isStreaming:a,handleClick:o}=e,s="group/tag relative h-[18px] rounded-full inline-flex items-center overflow-hidden -translate-y-px",r=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("span",{className:(0,C.Z)("relative transition-colors h-full max-w-[180px] overflow-hidden px-1.5 inline-flex items-center font-styrene text-xs tracking-tight rounded-full border-0.5 border-border-300 bg-bg-200 font-normal",!!n&&!a&&"group-hover/tag:bg-accent-secondary-900 group-hover/tag:border-accent-secondary-100/60"),children:(0,g.jsx)("span",{className:(0,C.Z)("text-nowrap text-text-300 break-all truncate font-normal",!a&&"group-hover/tag:text-text-200"),children:t})}),!!n&&(0,g.jsx)("span",{className:(0,C.Z)("transition-all opacity-[0%] h-[17px] absolute right-[0.5px] inline rounded-r-full flex items-center px-1.5 bg-gradient-to-r from-accent-secondary-900/0 via-accent-secondary-900/100 via-30% to-accent-secondary-900/100",!a&&"group-hover/tag:opacity-[100%]"),children:(0,g.jsx)(eI.G,{size:14,className:"transition-all group-hover/tag:ease-out duration-[500ms] ease-in text-accent-secondary-100 group-hover/tag:scale-[100%] scale-[80%] group-hover/tag:opacity-[100%] opacity-[0%] -mr-[2px]"})})]});return n?(0,g.jsx)("a",{href:n,target:"_blank",className:(0,C.Z)(s,"cursor-pointer"),onClick:o,children:r}):(0,g.jsx)("button",{className:(0,C.Z)(s,"cursor-default"),children:r})};function eW(e){let{citations:t,handleClick:n}=e,a=t.filter(e=>!!e.url),o=t.filter(e=>!e.url);return(0,g.jsxs)("div",{className:"flex flex-col p-1 gap-0.5",children:[a.map(e=>(0,g.jsx)(eK,{citation:e,handleClick:n,isHoverable:!0},e.uuid)),a.length>0&&o.length>0&&(0,g.jsx)("div",{className:"w-full border-t-0.5 border-border-300 h-0 min-h-0 my-2"}),o.map(e=>(0,g.jsx)(eK,{citation:e,handleClick:n,isHoverable:!0},e.uuid))]})}function eK(e){let t,n,a,{citation:o,handleClick:s,isHoverable:r}=e;switch(o.metadata.type){case"webpage_metadata":t=(0,g.jsx)(eH,{url:o.metadata.favicon_url,size:12}),n=o.metadata.site_name,a=o.title;break;case"google_doc_metadata":t=(0,g.jsx)(eT,{size:14,variant:p.DOCS}),n=(0,g.jsx)(E.Z,{defaultMessage:"Google Doc",id:"7qYF66c9/s"}),a=o.title;break;default:{let e=(0,g.jsx)(eF.J,{size:14,className:"text-text-500"});t=o.metadata.icon_url?(0,g.jsx)(eA,{style:{maxWidth:14,maxHeight:14},className:"object-contain",width:14,height:14,src:o.metadata.icon_url,fallbackSvg:e,alt:"favicon"}):e,n=o.metadata.source,a=o.metadata.preview_title}}let i=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("h3",{className:"font-styrene text-sm font-medium",children:a}),(0,g.jsxs)("span",{className:"flex flex-row items-center gap-1 text-text-500 text-xs font-normal",children:[t,(0,g.jsx)("p",{className:"font-normal text-[0.6875rem]",children:n})]})]});if(o.url){var l;return(0,g.jsx)("a",{href:null!==(l=o.url)&&void 0!==l?l:"",target:"_blank",className:(0,C.Z)("transition-all flex flex-col gap-1 px-2 py-1.5 rounded-md",r&&"hover:border-transparent hover:bg-bg-300"),onClick:()=>s(o),children:i})}return(0,g.jsx)("div",{className:"transition-all flex flex-col gap-1 px-2 py-1.5 rounded-md cursor-default",children:i})}var eJ=n(52939);let eQ=e=>{let{isOpen:t=!1,url:n,onClose:a,onConfirm:o}=e,s=(0,M.Z)();return(0,g.jsxs)(eJ.u_,{title:s.formatMessage({defaultMessage:"Open a link from the web",id:"EImP5C2Oec"}),isOpen:t,onClose:a,children:[(0,g.jsxs)("p",{className:"break-words flex flex-col gap-1 pt-3",children:[(0,g.jsx)(E.Z,{defaultMessage:"You’re about to be navigated to an external link.",id:"ojv1peCtoq"}),(0,g.jsx)("pre",{className:"font-mono text-wrap text-sm p-2 rounded border border-border-400 bg-bg-100",children:n})]}),(0,g.jsxs)(eJ.dm,{children:[(0,g.jsx)(_.z,{onClick:o,children:(0,g.jsx)(E.Z,{defaultMessage:"Open link",id:"YtFTtANjPw"})}),(0,g.jsx)(_.z,{variant:"secondary",onClick:a,children:(0,g.jsx)(E.Z,{defaultMessage:"Cancel",id:"47FYwba+bI"})})]})]})},eY=/(#[0-9a-fA-F]{6})\b/,eX=e=>{let{color:t}=e;return(0,g.jsx)("span",{className:"inline-block w-3 h-3 border-[0.5px] border-border-200 rounded flex-shrink-0 shadow-sm mr-1 align-middle",style:{backgroundColor:t}})},e0=(e,t)=>(0,g.jsxs)(k.Fragment,{children:[(0,g.jsx)(eX,{color:e}),e]},t),e1=(e,t,n)=>e.split(eY).map((e,a)=>a%2==1?t?e0(e,a):n(e,a):e),e5=(e,t)=>(0,g.jsxs)(O.code,{inline:!0,className:"inline-flex items-center h-5",children:[(0,g.jsx)(eX,{color:e}),e]},t),e2=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return k.Children.map(e,e=>"string"==typeof e?e1(e,t,e5):e)};function e3(){let e=(0,L._)(["\n  tracking-tighter\n  flex-1\n  text-left\n  mr-4\n  [&_a]:font-medium\n  [&_a]:hover:underline\n"]);return e3=function(){return e},e}let e4=[],e8=(0,k.memo)(e=>{var t,n;let{text:a,blockCitations:o=[],hasLinkRef:s,hasCodeRef:r,className:i,linkTarget:l="_blank",isStreaming:c=!1,flagShowCodeHeader:d,unsafeAllowNavigationWithoutConfirmation:u,onOpenArtifact:p,isLastMessage:m,publishedArtifacts:h,useInHouseLatexPlugin:v,messageUuid:f}=e,x=(0,k.useRef)(null),b=null!=h?h:e4,_=eh();(0,k.useEffect)(()=>{let e=e=>{var t,n,a;let o=window.getSelection();if(o&&(null===(t=x.current)||void 0===t?void 0:t.contains(o.anchorNode))){let t=o.getRangeAt(0).cloneContents(),s=document.createElement("div");for(let e of(s.appendChild(t),s.getElementsByTagName("*")))e.removeAttribute("color"),e.removeAttribute("fontFamily");null===(n=e.clipboardData)||void 0===n||n.setData("text/html",s.innerHTML),null===(a=e.clipboardData)||void 0===a||a.setData("text/plain",s.textContent||""),e.preventDefault()}};return document.addEventListener("copy",e),()=>{document.removeEventListener("copy",e)}},[]);let{value:y}=(0,z.FL)("latex_ga"),w=null!==(n=null===(t=ep())||void 0===t?void 0:t.preview_feature_uses_latex)&&void 0!==n&&n,j=y||w,S=!!p,{remarkMath:N,rehypeKatex:M,inHouseLatexPlugin:E}=ed(),R=(0,k.useMemo)(()=>a.replace(/(^|\n)(\s?)•(\s?)/g,"$1$2- "),[a]),T=(0,k.useMemo)(()=>({h1:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)("h1",{className:"text-2xl font-bold mt-1 text-text-100",...a,children:e2(n)})},h2:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)("h2",{className:"text-xl font-bold text-text-100 mt-1 -mb-0.5",...a,children:e2(n)})},h3:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)("h3",{className:"text-lg font-bold text-text-100 mt-1 -mb-1.5",...a,children:e2(n)})},h4:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)("h4",{className:"text-base font-bold text-text-100 mt-1",...a,children:e2(n)})},p:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)(O.p,{...a,children:e2(n)})},blockquote:e=>{let{node:t,children:n,...a}=e;return(0,g.jsx)("blockquote",{className:"border-border-200 border-l-4 pl-4",...a,children:e2(n)})},li:e=>{let{node:t,ordered:n,children:a,...o}=e;return(0,g.jsx)(O.li,{...o,children:e2(a)})},ul:e=>{let{node:t,ordered:n,...a}=e;return(0,g.jsx)(O.ul,{...a})},ol:e=>{let{node:t,ordered:n,...a}=e;return(0,g.jsx)(O.ol,{...a})},img:e=>{let{node:t,...n}=e;return u?(0,g.jsx)("img",{...n}):(0,g.jsx)(e6,{...n})},code(e){var t,n;let{node:a,...o}=e;if(r&&!o.inline&&(r.current=!0),!o.inline)return(0,g.jsx)(O.code,{...o,flagShowCodeHeader:d});let s=null===(t=o.children)||void 0===t?void 0:t[0];return"string"==typeof s&&s===s.trim()&&eY.test(s)?(null===(n=s.match(eY))||void 0===n?void 0:n[0])===s?(0,g.jsxs)(O.code,{...o,className:(0,C.Z)(o.className,"inline-flex items-center h-5"),flagShowCodeHeader:d,children:[(0,g.jsx)(eX,{color:s}),s]}):(0,g.jsx)(O.code,{...o,flagShowCodeHeader:d,children:s}):(0,g.jsx)(O.code,{...o,flagShowCodeHeader:d,children:o.children})},a(e){let{node:t,...n}=e;return s&&(s.current=!0),u?(0,g.jsx)("a",{target:l,...n}):(0,g.jsx)(e7,{linkTarget:l,...n})},table(e){let{node:t,...n}=e;return(0,g.jsx)("pre",{className:"font-styrene border-border-100/50 overflow-x-scroll w-full rounded border-[0.5px] shadow-[0_2px_12px_hsl(var(--always-black)/5%)]",children:(0,g.jsx)("table",{className:"bg-bg-100 min-w-full border-separate border-spacing-0 text-sm leading-[1.88888] whitespace-normal",...n})})},thead(e){let{node:t,...n}=e;return(0,g.jsx)("thead",{className:"border-b-border-100/50 border-b-[0.5px] text-left",...n})},tr(e){let{node:t,isHeader:n,...a}=e;return(0,g.jsx)("tr",{className:"[tbody>&]:odd:bg-bg-500/10",...a})},td(e){let{node:t,isHeader:n,children:a,...o}=e;return(0,g.jsx)("td",{className:"border-t-border-100/50 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] border-t-[0.5px] px-2 [&:not(:first-child)]:border-l-[0.5px]",...o,children:e2(a)})},th(e){let{node:t,isHeader:n,children:a,...o}=e;return(0,g.jsx)("th",{className:"text-text-000 [&:not(:first-child)]:-x-[hsla(var(--border-100) / 0.5)] font-400 px-2 [&:not(:first-child)]:border-l-[0.5px]",...o,children:e2(a)})},artifactComponent(e){let{node:t}=e;return(0,g.jsx)(e9,{properties:t.properties,isStreaming:c,isLastMessage:m,onOpenArtifact:p,publishedArtifacts:b})},..._?{[Q]:e=>{let{node:t,...n}=e;return(0,g.jsx)(e$,{...n,isStreaming:c,citationUuids:t.properties.citationUuids,messageUuid:f})}}:null}),[_,u,r,d,s,l,c,m,p,b,f]),q=(0,k.useMemo)(()=>{let e=[ey.Z,en];return S&&e.push(K),j&&N&&(v?e.push(E):e.push([N,{singleDollarTextMath:!1}])),_&&(e.push(e_.Z),e.push(et)),e},[S,j,N,_,v,E]),P=(0,k.useMemo)(()=>{let e=[];return j&&M&&e.push([M,{errorColor:"inherit"}]),e},[M,j]);return(0,g.jsx)("div",{ref:x,tabIndex:0,children:(0,g.jsx)(eD,{blockCitations:o,children:(0,g.jsx)(eb.D,{className:(0,C.Z)("grid-cols-1 grid gap-2.5 [&_>_*]:min-w-0",i),remarkPlugins:q,rehypePlugins:P,components:T,children:R})})})});e8.displayName="StandardMarkDown";let e6=e=>{let{src:t,...n}=e,[a,o]=(0,k.useState)(!1),s=()=>{window.open(t,"_blank")};return t?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("button",{onClick:()=>o(!0),className:"bg-bg-300 border-border-300 font-styrene text-text-300 inline-block grid h-32 w-40 items-center justify-items-center rounded-xl border p-4",children:(0,g.jsx)(E.Z,{defaultMessage:"Show Image",id:"eFsJ8k8yFm"})}),(0,g.jsx)(eQ,{isOpen:a,url:t,onClose:()=>o(!1),onConfirm:()=>{s(),o(!1)}})]}):(0,g.jsx)("img",{...n})},e7=e=>{let{linkTarget:t,href:n,className:a,...o}=e,[s,r]=(0,k.useState)(!1),i=()=>{window.open(n,t)};return n?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)("a",{className:(0,C.Z)("underline",a),onClick:e=>{e.preventDefault(),r(!0)},href:n,...o}),(0,g.jsx)(eQ,{isOpen:s,url:n,onClose:()=>r(!1),onConfirm:()=>{i(),r(!1)}})]}):(0,g.jsx)("a",{...o})};function e9(e){let{properties:t,isStreaming:n,isEdit:a,isNotLastEdit:o,onOpenArtifact:s,preview:r,isExpanded:i}=e,[c,d]=(0,k.useState)(!!t.type);(0,k.useEffect)(()=>{t.type&&d(!0)},[t.type]);let u=(0,M.Z)(),p=function(){let e=(0,M.Z)();return(0,k.useMemo)(()=>({[l.Text]:e.formatMessage({defaultMessage:"Text",id:"aA8bDwsPeJ"}),[l.Markdown]:e.formatMessage({defaultMessage:"Document",id:"wmirkPk7bp"}),[l.Html]:e.formatMessage({defaultMessage:"Interactive artifact",id:"zfnwA1wU0m"}),[l.Svg]:e.formatMessage({defaultMessage:"Image",id:"+0zv6gS/c6"}),[l.Code]:e.formatMessage({defaultMessage:"Code",id:"h2vipunVVd"}),[l.Mermaid]:e.formatMessage({defaultMessage:"Diagram",id:"PBUs06BBR7"}),[l.React]:e.formatMessage({defaultMessage:"Interactive artifact",id:"zfnwA1wU0m"})}),[e])}(),m=t.type?p[t.type]:null,h=e.versionNum&&e.versionCount&&e.versionNum>1&&e.versionCount>1,v=t.title&&t.id&&!n?"generated":a&&n?"editing":t.title&&t.id?"partial":"generating",f=t.type===l.Markdown||t.type===l.Text,x=f||t.type===l.Code;return(0,g.jsx)("button",{className:(0,C.Z)("flex text-left font-styrene rounded-xl mb-1 -mx-0.5 overflow-hidden border transition duration-300 w-full hover:bg-bg-000/50",o&&a&&"opacity-0 pointer-events-none transition-none",i?"border-accent-secondary-200 duration-500":"border-border-300 hover:border-border-200"),onClick:()=>{s&&t.id&&s(t.id)},"aria-label":u.formatMessage({defaultMessage:"Preview contents",id:"hmKJSoIQ4a"}),children:(0,g.jsxs)("div",{className:"artifact-block-cell group/artifact-block flex flex-1 align-start justify-between w-full pl-0.5 py-0.5",children:[(0,g.jsxs)("div",{className:"flex flex-col gap-1 py-4 px-4",children:[(0,g.jsx)("div",{className:(0,C.Z)("leading-tight text-sm","generating"===v?"text-text-500":null),children:"generated"===v?(0,g.jsx)(g.Fragment,{children:t.title}):"editing"===v?(0,g.jsx)(E.Z,{defaultMessage:"Making edits...",id:"0HUNCOubmp"}):"partial"===v?(0,g.jsx)(g.Fragment,{children:t.title}):(0,g.jsx)(eg,{children:(0,g.jsx)(E.Z,{defaultMessage:"Drafting artifact...",id:"8NQAeTqGOl"})})}),(0,g.jsxs)("div",{className:(0,C.Z)("text-sm","generating"===v?"text-text-500":"text-text-300",m?"opacity-100":"opacity-0","transition-opacity duration-200"),children:[m,m&&h?(0,g.jsx)(g.Fragment,{children:" ∙ "}):null,h?(0,g.jsx)(E.Z,{defaultMessage:"Version {versionNum}",id:"iMMX+ZCJ/I",values:{versionNum:e.versionNum}}):null,"\xa0"]})]}),(0,g.jsx)("div",{className:"flex items-end artifact-block-cell-preview relative",children:(0,g.jsx)("div",{className:(0,C.Z)("absolute inset-0 flex flex-1 overflow-hidden","rounded-t-lg border-0.5 border-border-200 select-none","scale-[1] group-hover/artifact-block:scale-[1.035]","rotate-[0.1rad] group-hover/artifact-block:rotate-[0.065rad]","duration-300 ease-out group-hover/artifact-block:duration-400 group-hover/artifact-block:ease-[cubic-bezier(0,0.9,0.5,1.35)]","transition-transform backface-hidden will-change-transform",c?"translate-y-[19%]":"translate-y-[120%]",t.type===l.Code?"bg-always-black text-always-white":f?"bg-bg-000 text-text-500":"bg-gradient-to-b from-bg-000 to-bg-000/0",x?"whitespace-pre-wrap text-[0.35rem] leading-none p-2 font-mono":"text-accent-brand pt-1 items-center justify-center h-full"),children:x?r:t.type===l.Svg?(0,g.jsx)(ev.E,{size:32,weight:"light"}):t.type===l.React||t.type===l.Html?(0,g.jsx)(ef.h,{size:32,weight:"light"}):t.type===l.Code?(0,g.jsx)(ex.E,{size:32,weight:"light"}):(0,g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",width:"36",height:"36",children:(0,g.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",d:"M2 8a5 5 0 0 0 4-2 5 5 0 0 0 4 2 5 5 0 0 0 4-2 5 5 0 0 0 4 2 5 5 0 0 0 4-2M2 18a5 5 0 0 0 4-2 5 5 0 0 0 4 2 5 5 0 0 0 4-2 5 5 0 0 0 4 2 5 5 0 0 0 4-2"})})})})]})})}em.q.div(e3());let te=(0,k.forwardRef)((e,t)=>{let{className:n,children:a,disabled:o,noDefaultScroll:s}=e,r=(0,k.useRef)(0),i=(0,k.useRef)(!0),l=(0,k.useRef)(null),c=(0,k.useCallback)(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"auto";if(l.current&&i.current){if(l.current.scrollHeight-l.current.clientHeight<l.current.scrollTop)return;if(l.current&&"function"==typeof l.current.scrollTo){var t,n,a;null===(a=l.current)||void 0===a||a.scrollTo({top:(null===(t=l.current)||void 0===t?void 0:t.scrollHeight)-(null===(n=l.current)||void 0===n?void 0:n.clientHeight)+5,behavior:e})}}},[]),d=(0,k.useCallback)(e=>{if(l.current&&l.current&&"function"==typeof l.current.scrollTo){var t,n,a;l.current.style.overflow="hidden",null===(a=l.current)||void 0===a||a.scrollTo({top:(null===(t=l.current)||void 0===t?void 0:t.scrollHeight)*e-(null===(n=l.current)||void 0===n?void 0:n.clientHeight)/2,behavior:"auto"})}},[]),u=(0,k.useCallback)(()=>{l.current&&(l.current.style.overflow="")},[]);return(0,k.useImperativeHandle)(t,()=>({reset(){r.current=0,i.current=!0,s||c()},scrollToBottomIfPinned:c,scrollToPercentage:d,enableScrolling:u}),[c,d,u,s]),(0,k.useLayoutEffect)(()=>{o||!a||s||c()},[a,o,c,s]),(0,g.jsx)("div",{className:n,onScroll:e=>{if(o)return;let t=e.currentTarget.scrollTop,n=function(e,t){if(!e)return!1;{let n=e.scrollHeight-8;return Math.ceil(t+e.offsetHeight)>=Math.floor(n)}}(l.current,t),a=t>r.current;n&&a?i.current=!0:n||a||(i.current=!1),r.current=t},ref:l,children:a})});function tt(e){let{Icon:t,children:n,isAssistant:a=!0,tooltipContent:o,...s}=e;return(0,g.jsx)(y.u,{className:"mt-1",side:"bottom",delayDuration:100,tooltipContent:o,children:(0,g.jsxs)("button",{...s,className:(0,C.Z)("flex flex-row items-center gap-1.5 rounded-md p-2 text-sm transition text-text-300 active:scale-95","select-auto",a?"hover:bg-bg-300 py-1.5":"hover:bg-bg-500 py-1",s.className),children:[t&&(0,g.jsx)(t,{size:16}),n]})})}te.displayName="AutoScroll";let tn=/(macintosh|macintel|macppc|mac68k|macos)/i;var ta=n(52681),to=n(4911),ts=n(7583),tr=n(26475);let ti=e=>{let{isStreaming:t,children:n,...a}=e;return t?n:(0,g.jsx)(tl,{...a,children:n})},tl=e=>{let{children:t,sendMessage:n,contentType:a="text",isOpen:o}=e,s=(0,M.Z)(),r=void 0!==n,[i,l]=(0,k.useState)([]),[c,d]=(0,k.useState)({top:0,left:0,width:0}),[u,p]=(0,k.useState)(!1),[m,h]=(0,k.useState)(!1),[v,f]=(0,k.useState)(""),[x,b]=(0,k.useState)(""),[y,w]=(0,k.useState)(!1),j=(0,k.useRef)(null),S=(0,k.useRef)(null),z=(0,k.useCallback)((e,t)=>{var n;let a=function(e,t){let n=[];for(let a=0;a<e.rangeCount;a++){let o=e.getRangeAt(a);if(o.startContainer===o.endContainer&&o.startContainer.nodeType===Node.TEXT_NODE){let e=o.startContainer,t=document.createRange();for(let a=o.startOffset;a<o.endOffset;a++){t.setStart(e,a),t.setEnd(e,a+1);let o=Array.from(t.getClientRects());n.push(...o)}t.detach()}else{let e=function(e){let t;let n=[],a=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT,t=>e.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT);for(;t=a.nextNode();)n.push(t);return n}(o);e.forEach((a,s)=>{let r=document.createRange(),i="length"in a?a.length:0,l=0===s,c=s===e.length-1,d=l?o.startOffset:0,u=c&&!t?o.endOffset:i;r.setStart(a,d),r.setEnd(a,u);let p=Array.from(r.getClientRects());n.push(...p),r.detach()})}}return n}(e,t),o=null===(n=j.current)||void 0===n?void 0:n.getBoundingClientRect();return Array.from(a).map(e=>({top:e.top-((null==o?void 0:o.top)||0)-2.5,left:e.left-((null==o?void 0:o.left)||0),width:e.width,height:e.height+5.5}))},[]),N=(0,k.useCallback)(e=>{var t;let n=e.getRangeAt(0);return null===(t=j.current)||void 0===t?void 0:t.contains(n.commonAncestorContainer)},[]);(0,k.useEffect)(()=>{function e(e){var t,n,a,o;let s,r,{selection:i,isSelectAll:c}=e,u=z(i,c);if(u.every((e,t,n)=>0===t||5>Math.abs(e.top-n[0].top))){let e=Math.max(...u.map(e=>e.left+e.width));s=u[0].top-9,r=e+10}else{let e=Math.max(...u.map(e=>e.top+e.height));r=Math.min(...u.map(e=>e.left)),s=Math.min((null!==(a=null===(n=j.current)||void 0===n?void 0:n.scrollHeight)&&void 0!==a?a:0)-50,e)}let m=((null!==(o=null===(t=j.current)||void 0===t?void 0:t.scrollWidth)&&void 0!==o?o:1e3)-r)/3*2;l(u),p(!0),h(!1),d({top:s,left:r,width:m}),b(i.toString())}let t=()=>{w(!0)},n=t=>{"Escape"===t.key&&(h(!1),p(!1),f(""),l([]));let n=(!function(){let e=window.navigator.userAgent.toLowerCase();return tn.test(e)}()?t.ctrlKey:t.metaKey)&&"a"===t.key,a=j.current;if(a&&o&&n){let n=document.activeElement&&(document.activeElement===a||(null==a?void 0:a.contains(document.activeElement))),o=window.getSelection();if(n&&o){t.preventDefault();let n=document.createRange();n.selectNodeContents(a),o.removeAllRanges(),o.addRange(n),e({selection:o,isSelectAll:!0})}}},a=t=>{if(S.current&&S.current.contains(t.target))return;let n=window.getSelection();n&&!n.isCollapsed&&N(n)?e({selection:n}):(l([]),p(!1),h(!1),b(""),f("")),w(!1)};return r&&(document.addEventListener("mousedown",t),document.addEventListener("mouseup",a),document.addEventListener("keydown",n)),()=>{document.removeEventListener("mousedown",t),document.removeEventListener("mouseup",a),document.removeEventListener("keydown",n)}},[z,N,r,o]);let R=e=>{r&&(n(e),f(""),h(!1),p(!1),l([]))},T=()=>"text"===a?x.split("\n").map(e=>"> ".concat(e)).join("\n"):"code"===a?"```\n".concat(x,"\n```"):void 0,q=()=>{R({prompt:"".concat(T(),"\n\n").concat(v),attachments:[],files:[],syncSources:[]})};return(0,g.jsxs)("div",{className:"w-full h-full relative",children:[(0,g.jsx)("div",{ref:j,tabIndex:0,className:(0,C.W)("w-full h-full relative",r?y?"[&_:not(input)::selection]:bg-secondary-000/10":"[&_*::selection]:bg-secondary-000/10":""),children:t}),i.map((e,t)=>(0,g.jsx)("div",{className:"absolute pointer-events-none bg-accent-secondary-000/10",style:{top:e.top,left:e.left,width:e.width,height:e.height}},t)),(0,g.jsx)(ts.M,{children:u&&!m&&(0,g.jsx)(tr.E.div,{className:"absolute z-10",initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",damping:30,stiffness:400,delay:.2},style:{top:c.top+5,left:c.left},children:(0,g.jsx)("div",{className:"border-0.5 flex items-center rounded-lg px-2 pb-1 pt-3 shadow transition bg-bg-000 text-text-400 border-border-300",children:(0,g.jsxs)("div",{className:"-mx-1 -mt-2 flex items-stretch justify-between gap-0.5",children:[(0,g.jsxs)(tt,{onClick:()=>{h(!0)},isAssistant:!0,children:[(0,g.jsx)(ta.A,{size:16}),(0,g.jsx)(E.Z,{defaultMessage:"Improve",id:"BATKcMm/a2"})]}),(0,g.jsxs)(tt,{onClick:()=>{R({prompt:"".concat(s.formatMessage({defaultMessage:"Can you explain this section to me in more detail?",id:"LMDbiRxyDQ"}),"\n\n").concat(T()),attachments:[],files:[],syncSources:[]})},isAssistant:!0,children:[(0,g.jsx)(to.v,{size:16}),(0,g.jsx)(E.Z,{defaultMessage:"Explain",id:"HGdgPPM2Ry"})]})]})})})}),(0,g.jsx)(ts.M,{children:m&&(0,g.jsxs)(tr.E.form,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{type:"spring",damping:30,stiffness:400},className:"z-10 absolute flex gap-2 p-2 pl-4 items-center h-12 rounded-lg bg-bg-000 text-text-200 border border-0.5 border-border-300 shadow-xl",style:{top:c.top+5,left:c.left,width:c.width},ref:S,onSubmit:e=>{e.preventDefault(),q()},children:[(0,g.jsx)("input",{type:"text",value:v,onChange:e=>f(e.target.value),placeholder:s.formatMessage({defaultMessage:"Describe what you would like to update...",id:"smio7jldoW"}),className:"py-0.5 px-0 border-0 bg-transparent text-sm grow !shadow-none text-text-200 placeholder-text-500 hide-focus-ring",autoFocus:!0}),(0,g.jsx)(ts.M,{children:v.trim().length>0?(0,g.jsx)(tr.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",damping:30,stiffness:400,delay:0},children:(0,g.jsx)(_.z,{onClick:()=>q(),"aria-label":s.formatMessage({defaultMessage:"Send Message",id:"yJAKR0Ngpn"}),type:"submit",children:(0,g.jsx)("div",{className:"flex items-center gap-2 select-none",children:(0,g.jsx)(E.Z,{defaultMessage:"Update",id:"BWpuKlRSA1"})})})}):null})]})})]})},tc=e=>{let{title:t,description:n,inset:a,action:o}=e;return(0,g.jsxs)("div",{className:"border-border-300 shadow-sm w-[300px] max-w-full bg-bg-000 rounded-xl p-5 border",children:[(0,g.jsx)("div",{className:"text-left mb-2 font-medium text-sm",children:t}),(0,g.jsx)("p",{className:"mb-2 text-sm",children:n}),!!a&&(0,g.jsx)("div",{className:"flex flex-col rounded-md bg-text-000 bg-opacity-5 p-4 font-mono text-xs text-text-300",children:a}),o&&(0,g.jsx)("div",{className:"flex justify-end",children:(0,g.jsx)(_.z,{variant:"primary",className:"mt-4 text-sm",onClick:o.onClick,disabled:o.disabled,loading:o.loading,children:o.label})})]})},td=e=>{var t,n,a;let{error:o,sendMessage:s,isStreaming:r}=e,[i,l]=(0,k.useState)(!1),c=(0,M.Z)(),d=function(e,t){switch(e.type){case"UnsupportedImports":return{title:t?t.formatMessage({defaultMessage:"Artifact failed to load",id:"NcDXiSfIPe"}):"Artifact failed to load",description:t?t.formatMessage({defaultMessage:"The generated artifact uses libraries we don’t support:",id:"HG0Hu8xIQA"}):"The generated artifact uses libraries we don’t support:",inset:[...e.unsupportedModules,...e.nonExistentIcons.map(e=>"{ ".concat(e,' } from "lucide-react"'))],subtext:t?t.formatMessage({defaultMessage:"The code itself may still work. To use it, you’ll need a development setup with these libraries installed.",id:"Et/uvuRBba"}):"The code itself may still work. To use it, you’ll need a development setup with these libraries installed."};case"RuntimeError":return{title:t?t.formatMessage({defaultMessage:"Error running artifact",id:"JU2kK1J3jY"}):"Error running artifact",description:t?t.formatMessage({defaultMessage:"An error occurred while trying to run the generated artifact.",id:"3RpkNRAyPc"}):"An error occurred while trying to run the generated artifact.",inset:[e.message],insetStyle:"danger"};case"FileNotFound":return{title:t?t.formatMessage({defaultMessage:"File not found",id:"gcaJtRf4b0"}):"File not found",description:t?t.formatMessage({defaultMessage:"The file “{fileName}” could not be found.",id:"0kOCGtB3eN"},{fileName:e.fileName}):"The file “".concat(e.fileName,"” could not be found."),subtext:t?t.formatMessage({defaultMessage:"Please check the file name and try again.",id:"/fdYJU5SMC"}):"Please check the file name and try again."};case"ClaudeCompletionError":return{title:t?t.formatMessage({defaultMessage:"Error in Claude completion",id:"ya5HK9oB9T"}):"Error in Claude completion",description:e.message}}}(o.error,c),u="> ".concat(d.description,"\n  ").concat(null!==(a=null===(t=d.inset)||void 0===t?void 0:t.map(e=>"> `".concat(e,"`")).join("\n"))&&void 0!==a?a:"","\n  \n\n  Can you fix this error in `").concat(o.artifactId,"`?"),p=s?{label:c.formatMessage({defaultMessage:"Try fixing with Claude",id:"wrcoZ2Zo0b"}),onClick:()=>{l(!0),null==s||s({prompt:u,attachments:[],files:[],syncSources:[]})},disabled:r,loading:i}:void 0;return(0,g.jsx)("div",{className:"absolute bottom-5 left-5 right-5",children:(0,g.jsx)(tc,{title:d.title,description:d.description,inset:(null===(n=d.inset)||void 0===n?void 0:n.length)?d.inset?(0,g.jsx)("ul",{children:d.inset.map((e,t)=>(0,g.jsx)("li",{children:e},t))}):null:void 0,action:p})})},tu=q.z.object({channel:q.z.enum(["request","response"]),requestId:q.z.string()}).passthrough(),tp=tu.strict().extend({channel:q.z.literal("request"),method:q.z.string(),payload:q.z.strictObject({"@type":q.z.string()})}),tm=tu.extend({channel:q.z.literal("response"),status:q.z.number().int().min(100).max(599),payload:q.z.strictObject({"@type":q.z.string()}).passthrough()}).passthrough(),tg=tm.extend({status:q.z.number().int().min(400).max(599),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.ErrorResponse"),error:q.z.string()})}),th=tm.extend({payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/google.protobuf.Empty")})}),tv={"@type":"type.googleapis.com/google.protobuf.Empty"},tf=e=>({"@type":"type.googleapis.com/anthropic.claude.usercontent.ErrorResponse",error:e});(i=m||(m={})).ReadyForContent="anthropic.claude.usercontent.sandbox.ReadyForContent",i.SetContent="anthropic.claude.usercontent.sandbox.SetContent",i.GetFile="anthropic.claude.usercontent.sandbox.GetFile",i.SendConversationMessage="anthropic.claude.usercontent.sandbox.SendConversationMessage",i.RunCode="anthropic.claude.usercontent.sandbox.RunCode",i.ClaudeCompletion="anthropic.claude.usercontent.sandbox.ClaudeCompletion",i.ReportError="anthropic.claude.usercontent.sandbox.ReportError",i.GetScreenshot="anthropic.claude.usercontent.sandbox.GetScreenshot",i.BroadcastContentSize="anthropic.claude.usercontent.sandbox.BroadcastContentSize",i.OpenExternal="anthropic.claude.usercontent.sandbox.OpenExternal",i.CopyHtmlContent="anthropic.claude.usercontent.sandbox.CopyHtmlContent";let tx=q.z.object({type:q.z.literal("UnsupportedImports"),unsupportedModules:q.z.array(q.z.string()),nonExistentIcons:q.z.array(q.z.string())}),tb=q.z.object({type:q.z.literal("RuntimeError"),message:q.z.string()}),t_=q.z.object({type:q.z.literal("FileNotFound"),fileName:q.z.string()}),ty=q.z.object({type:q.z.literal("ClaudeCompletionError"),message:q.z.string()}),tw=q.z.discriminatedUnion("type",[tx,tb,t_,ty]);q.z.object({code:q.z.string()});let tj=q.z.object({status:q.z.enum(["success","error"]),result:q.z.string().optional(),logs:q.z.array(q.z.string()),error:q.z.string().optional()}),tC={"anthropic.claude.usercontent.sandbox.CopyHtmlContent":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.CopyHtmlContent"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentRequest")})}),responseSchema:tm.extend({payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentResponse"),reportHTMLContent:q.z.string()})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.SetContent":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.SetContent"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"),content:q.z.string(),type:q.z.nativeEnum(l),watchContentSize:q.z.boolean().optional()})}),responseSchema:th,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReadyForContent":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.ReadyForContent"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:th,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.BroadcastContentSize":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.BroadcastContentSize"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.BroadcastContentSizePayload"),height:q.z.number(),width:q.z.number()})}),responseSchema:th,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.GetFile":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.GetFile"),payload:q.z.strictObject({key:q.z.string(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileRequest")})}),responseSchema:tm.extend({payload:q.z.strictObject({value:q.z.instanceof(Uint8Array).nullable(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.SendConversationMessage":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.SendConversationMessage"),payload:q.z.strictObject({message:q.z.string(),messageType:q.z.enum(["text","error"]),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.SendConversationMessageRequest")})}),responseSchema:th,alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.RunCode":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.RunCode"),payload:q.z.strictObject({code:q.z.string(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeRequest")})}),responseSchema:tm.extend({payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.RunCodeResponse")}).merge(tj)}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ClaudeCompletion":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.ClaudeCompletion"),payload:q.z.strictObject({prompt:q.z.string(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionRequest")})}),responseSchema:tm.extend({payload:q.z.strictObject({completion:q.z.string().nullable(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.ReportError":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.ReportError"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.ReportErrorRequest"),error:tw})}),responseSchema:th,alwaysPermitted:!0},"anthropic.claude.usercontent.sandbox.GetScreenshot":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.GetScreenshot"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/google.protobuf.Empty")})}),responseSchema:tm.extend({payload:q.z.strictObject({screenshot:q.z.string().nullable(),"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.GetScreenshotResponse")})}),alwaysPermitted:!1},"anthropic.claude.usercontent.sandbox.OpenExternal":{requestSchema:tp.extend({method:q.z.literal("anthropic.claude.usercontent.sandbox.OpenExternal"),payload:q.z.strictObject({"@type":q.z.literal("type.googleapis.com/anthropic.claude.usercontent.sandbox.OpenExternal"),href:q.z.string()})}),responseSchema:th,alwaysPermitted:!0}},tk=q.z.enum(["anthropic.claude.usercontent.sandbox.ReadyForContent","anthropic.claude.usercontent.sandbox.GetFile","anthropic.claude.usercontent.sandbox.SendConversationMessage","anthropic.claude.usercontent.sandbox.ClaudeCompletion","anthropic.claude.usercontent.sandbox.ReportError","anthropic.claude.usercontent.sandbox.BroadcastContentSize","anthropic.claude.usercontent.sandbox.OpenExternal"]),tS=q.z.discriminatedUnion("method",[tC["anthropic.claude.usercontent.sandbox.ReadyForContent"].requestSchema,tC["anthropic.claude.usercontent.sandbox.GetFile"].requestSchema,tC["anthropic.claude.usercontent.sandbox.SendConversationMessage"].requestSchema,tC["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].requestSchema,tC["anthropic.claude.usercontent.sandbox.ReportError"].requestSchema,tC["anthropic.claude.usercontent.sandbox.BroadcastContentSize"].requestSchema,tC["anthropic.claude.usercontent.sandbox.OpenExternal"].requestSchema]);q.z.union([th,tC["anthropic.claude.usercontent.sandbox.GetFile"].responseSchema,tC["anthropic.claude.usercontent.sandbox.SendConversationMessage"].responseSchema,tC["anthropic.claude.usercontent.sandbox.ClaudeCompletion"].responseSchema]),q.z.enum(["anthropic.claude.usercontent.sandbox.SetContent","anthropic.claude.usercontent.sandbox.RunCode","anthropic.claude.usercontent.sandbox.GetScreenshot","anthropic.claude.usercontent.sandbox.CopyHtmlContent"]),q.z.discriminatedUnion("method",[tC["anthropic.claude.usercontent.sandbox.SetContent"].requestSchema,tC["anthropic.claude.usercontent.sandbox.RunCode"].requestSchema,tC["anthropic.claude.usercontent.sandbox.GetScreenshot"].requestSchema,tC["anthropic.claude.usercontent.sandbox.CopyHtmlContent"].requestSchema]);let tz=q.z.union([tC["anthropic.claude.usercontent.sandbox.SetContent"].responseSchema,tC["anthropic.claude.usercontent.sandbox.RunCode"].responseSchema,tC["anthropic.claude.usercontent.sandbox.GetScreenshot"].responseSchema,tC["anthropic.claude.usercontent.sandbox.CopyHtmlContent"].responseSchema]),tN=Object.entries(tC).filter(e=>{let[t,n]=e;return!0===n.alwaysPermitted}).map(e=>{let[t,n]=e;return t});class tM{setupMessageListener(){window.addEventListener("message",this.boundHandleMessage,!1)}handleMessage(e){if(e.origin!==this.allowedOrigin||e.source!==this.iframe.contentWindow)return;let t=Date.now();if(t-this.lastResetTime>this.RESET_INTERVAL&&(this.messageCount=0,this.lastResetTime=t),this.messageCount++,this.messageCount>this.MAX_MESSAGES_PER_INTERVAL){window.removeEventListener("message",this.boundHandleMessage),this.onRateLimited&&this.onRateLimited();return}let n=tu.safeParse(e.data);if(!n.success){console.warn("Received message does not conform to basic message shape, ignoring");return}let a=n.data;if("response"===a.channel){this.handleResponse(a);return}this.messageQueue.push(a),this.isConsumerRunning||this.consumeMessages()}handleResponse(e){let t=this.inFlightRequests.get(e.requestId);if(void 0!==t){t(e);return}}async consumeMessages(){for(this.isConsumerRunning=!0;this.messageQueue.length>0;){let e=this.messageQueue.shift();if(!e)continue;let t=tk.safeParse(e.method);if(!t.success){this.sendErrorResponse(e.requestId,400,"Unknown method");continue}let n=t.data,a=tS.safeParse(e);if(!a.success){this.sendErrorResponse(e.requestId,400,"Invalid payload content");continue}let o=a.data;if(this.requestLog.has(o.requestId)){this.sendErrorResponse(o.requestId,400,"Request ID already processed");continue}this.requestLog.set(o.requestId,{message:o,requestTimestamp:new Date().getTime()}),await this.onPermissionRequested(n).then(e=>"denied"!==e||(this.sendErrorResponse(o.requestId,403,"Permission denied"),!1)).catch(e=>(console.error("Error checking permission for method ".concat(n,":"),e),this.sendErrorResponse(o.requestId,500,"Error checking permission"),!1))&&(this.onCapabilityAction(o,this.boundSendRequest).then(e=>{var t;let n=tm.parse({channel:"response",status:200,requestId:o.requestId,payload:null!=e?e:tv}),a=this.requestLog.get(o.requestId);a&&this.requestLog.set(o.requestId,{...a,response:n,responseTimestamp:new Date().getTime()}),null===(t=this.iframe.contentWindow)||void 0===t||t.postMessage(n,this.allowedOrigin)}).catch(e=>{console.error("Error processing action for method ".concat(n,":"),e),this.sendErrorResponse(o.requestId,500,"Internal server error while processing action")}),await new Promise(e=>requestAnimationFrame(e)))}this.isConsumerRunning=!1}sendErrorResponse(e,t,n){var a;let o=tg.parse({channel:"response",status:t,requestId:e,payload:tf(n)}),s=this.requestLog.get(e);s&&this.requestLog.set(e,{...s,response:o,responseTimestamp:new Date().getTime()}),null===(a=this.iframe.contentWindow)||void 0===a||a.postMessage(o,this.allowedOrigin)}restartListening(){window.removeEventListener("message",this.boundHandleMessage),this.messageCount=0,this.lastResetTime=Date.now(),this.setupMessageListener()}cleanup(){window.removeEventListener("message",this.boundHandleMessage),this.messageQueue=[],this.isConsumerRunning=!1,this.inFlightRequests.clear()}async sendRequest(e,t){return new Promise((n,a)=>{var o;let s=Date.now().toString();this.inFlightRequests.set(s,e=>{let t=tm.safeParse(e);if(!t.success){a(Error("Invalid response format"));return}let o=t.data;if(o.status>=400){let e=tg.safeParse(o);e.success?a(Error(e.data.payload.error)):a(Error("Error response (".concat(o.status,")")));return}let s=tz.safeParse(o);s.success?n(s.data.payload):a(Error("Invalid response payload for the method"))}),null===(o=this.iframe.contentWindow)||void 0===o||o.postMessage({channel:"request",method:e,requestId:s,payload:t},this.allowedOrigin)})}getRequestLog(){return Array.from(this.requestLog.entries()).map(e=>{let[t,n]=e;return{...n,requestId:t}}).sort((e,t)=>t.requestTimestamp-e.requestTimestamp)}constructor({iframe:e,allowedOrigin:t,onRateLimited:n=null,onPermissionRequested:a,onCapabilityAction:o}){this.messageCount=0,this.lastResetTime=Date.now(),this.MAX_MESSAGES_PER_INTERVAL=30,this.RESET_INTERVAL=5e3,this.onRateLimited=null,this.messageQueue=[],this.isConsumerRunning=!1,this.requestLog=new Map,this.inFlightRequests=new Map,this.iframe=e,this.allowedOrigin=t,this.onRateLimited=n,this.onPermissionRequested=a,this.onCapabilityAction=o,this.boundHandleMessage=this.handleMessage.bind(this),this.boundSendRequest=this.sendRequest.bind(this),this.setupMessageListener()}}let tE=(0,k.forwardRef)((e,t)=>{let{content:n,className:a,type:o,onSandboxConfirmation:s,capabilities:r,onReportError:i,onSetContent:l,onRefresh:c,externalLinkBehavior:d,onOpenExternalLinkRequest:u,lazy:p=!0}=e,h=(0,M.Z)(),{userContentRendererUrl:v}=(0,ew.m)(),[f,x]=(0,k.useState)(!1),b=(0,k.useRef)(null),[y,w]=(0,k.useState)(null),{value:j}=(0,z.FL)("apps_use_turmeric"),[S,N]=(0,k.useState)(0),R=e=>e>=100,{sendRequest:T,updatePermission:q}=function(e){let{iframeRef:t,allowedOrigin:n,onRateLimited:a=null,initialPermissions:o,onPermissionRequested:s,onCapabilityAction:r}=e,[i,l]=(0,k.useState)(null),c=(0,k.useRef)(o),[d,u]=(0,k.useState)(0);(0,k.useEffect)(()=>{if(!t.current&&d<20){let e=setTimeout(()=>{u(e=>e+1)},500);return()=>clearTimeout(e)}if(!t.current){console.warn("Max retries reached while waiting for iframe");return}let e=new tM({iframe:t.current,allowedOrigin:n,onRateLimited:a,onPermissionRequested:async e=>{if(tN.includes(e)||"accepted"===c.current[e])return"accepted";let t=await s(e);return c.current={...c.current,[e]:t},t},onCapabilityAction:r});return l(e),()=>{e.cleanup()}},[t,n,c,a,s,r,d]);let p=(0,k.useCallback)(async(e,t)=>{if(i)return i.sendRequest(e,t);throw Error("Communicator not initialized")},[i]),m=(0,k.useCallback)(()=>{null==i||i.restartListening()},[i]),g=(0,k.useCallback)((e,t)=>{c.current={...c.current,[e]:t}},[]);return{sendRequest:null===i?void 0:p,restartListening:m,permissions:c.current,updatePermission:g}}({iframeRef:b,allowedOrigin:v,onCapabilityAction:(0,k.useCallback)(async e=>{if(e.method===m.ReadyForContent)return x(!0),null==s||s(),Promise.resolve();if(e.method===m.GetFile)return r&&r.getFile?Promise.resolve({"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.GetFileResponse",value:await r.getFile(e.payload.key)}):Promise.reject();if(e.method===m.SendConversationMessage)return r&&r.sendMessage?(await r.sendMessage({prompt:e.payload.message,attachments:[],files:[],syncSources:[]}),Promise.resolve()):Promise.reject();if(e.method===m.ClaudeCompletion)return r&&r.claudeComplete?(N(e=>e+1),Promise.resolve({"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.ClaudeCompletionResponse",completion:await r.claudeComplete(e.payload.prompt)})):Promise.reject();if(e.method===m.BroadcastContentSize)return Promise.resolve();if(e.method===m.OpenExternal){if("ask"===d)return w(e.payload.href),Promise.resolve();if("bubble"===d&&u)return u({href:e.payload.href}),Promise.resolve()}else if(e.method===m.ReportError)return null==i||i(e.payload.error),Promise.resolve();return Promise.reject()},[s,r,x,i,N,d,u]),onPermissionRequested:(0,k.useCallback)(async e=>e===m.ClaudeCompletion&&R(S)?"denied":Promise.resolve("accepted"),[S]),initialPermissions:{}});(0,k.useEffect)(()=>{R(S)&&(q(m.ClaudeCompletion,"denied"),(0,J.uT)("Claude completion request limit hit."))},[S,q]);let P=(0,k.useCallback)(()=>{(0,J.uT)("Claude completion modal confirmed"),N(0),q(m.ClaudeCompletion,"accepted")},[q]),A=(0,k.useCallback)(async e=>{let t=await (null==T?void 0:T(m.GetScreenshot,tv));if(!(null==t?void 0:t.screenshot))return;if(t.screenshot.length>10485760)throw Error(h.formatMessage({defaultMessage:"Screenshot too large",id:"ifBuzEbIz2"}));if(!/^data:image\/(png|jpeg|gif);base64,/.test(t.screenshot))throw Error(h.formatMessage({defaultMessage:"Invalid screenshot format",id:"KCmGxpLNuq"}));let n=e.title.replace(/[^a-zA-Z0-9-_]/g,"_").substring(0,50)+".png";Object.assign(document.createElement("a"),{href:t.screenshot,download:n}).click()},[h,T]),I=(0,k.useCallback)(async()=>{let e=await (null==T?void 0:T(m.CopyHtmlContent,{"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.CopyHtmlContentRequest"}));return null==e?void 0:e.reportHTMLContent},[T]);return(0,k.useEffect)(()=>{f&&n&&o&&(null==l||l(),null==T||T(m.SetContent,{content:n,type:o,"@type":"type.googleapis.com/anthropic.claude.usercontent.sandbox.SandboxContent"}))},[n,T,o,f,l]),(0,k.useImperativeHandle)(t,()=>({refresh:()=>{null==c||c(),x(!1);let e=b.current;e&&(e.src="".concat(v).concat(i?"?errorReportingMode=parent":""))},downloadScreenshot:A,copyHtmlContent:I})),(0,g.jsxs)("div",{className:(0,C.Z)("relative",a),children:[(0,g.jsx)("iframe",{ref:b,className:"h-full w-full",sandbox:"allow-scripts allow-same-origin",title:h.formatMessage({defaultMessage:"Claude content",id:"/Ma3teJf9/"}),loading:p?"lazy":void 0,src:"".concat(v).concat(i?"?errorReportingMode=parent":""),allow:"fullscreen"}),(0,g.jsx)(ts.M,{children:!f&&(0,g.jsx)(tr.E.div,{className:"bg-bg-100 absolute inset-0 z-10",initial:{opacity:1},animate:{opacity:1},exit:{opacity:0},transition:{duration:.15,ease:"easeInOut"}})}),y?(0,g.jsx)(eQ,{isOpen:!!y,url:y,onClose:()=>w(null),onConfirm:()=>{y&&window.open(y,"_blank"),w(null)}}):null,j&&R(S)&&(0,g.jsx)("div",{className:"fixed inset-0 bg-always-black bg-opacity-50 flex items-center justify-center z-modal",children:(0,g.jsxs)("div",{className:"bg-bg-100 p-4 rounded shadow-lg",children:[(0,g.jsx)("p",{className:"text-fg-100 mb-4",children:(0,g.jsx)(E.Z,{defaultMessage:"Many requests made. Acknowledge that you’re still here to continue.",id:"kmh/1AmVcl"})}),(0,g.jsx)(_.z,{onClick:P,variant:"primary",children:(0,g.jsx)(E.Z,{defaultMessage:"I’m still here",id:"NwhjMfjigc"})})]})})]})});tE.displayName="RichSandbox";let tR="opacity-30 blur-[2px]",tT=e=>{let{isOpen:t,content:n,language:a,citations:o,type:s,showRaw:r,richSandboxRef:i,isCurrentStreaming:c,isChatStreaming:d,onSandboxConfirmation:u,sendMessage:p,richSandboxCapabilities:m,isLatestVersion:h,artifactId:v,artifactVersion:f,onArtifactRuntimeError:x,artifact:b,hasMenuOpen:_}=e,y=void 0!==s&&void 0!==n&&s!==l.Code&&s!==l.Markdown,w=(0,k.useRef)(null),j=y&&!r,[S,z]=(0,k.useState)(null),N=(0,k.useCallback)(e=>{void 0!==v&&void 0!==f&&(void 0!==x&&x(e),z({error:e,artifactId:v,artifactVersion:f}))},[v,f,x]);(0,k.useEffect)(()=>{var e;if(!b||!c)return;let t=b.versions[b.versions.length-1],n=b.versions[b.versions.length-2];if(!n||!t||"update"!==t.command)return;let a=tA(n.resultState,t.resultState);-1!==a&&(null===(e=w.current)||void 0===e||e.scrollToPercentage(a/100))},[n,b,c]),(0,k.useEffect)(()=>{!c&&w.current&&w.current.enableScrolling()},[c]);let M=(0,k.useCallback)(()=>{z(e=>e&&(e.artifactId!==v||e.artifactVersion!==f)?null:e)},[v,f]),E=(0,k.useCallback)(()=>{z(null)},[]);return(0,g.jsxs)(g.Fragment,{children:[y&&(0,g.jsxs)("div",{className:(0,C.Z)("ease-out duration-200",j?"h-full w-full relative border-none":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none",_&&tR),children:[(0,g.jsx)(tE,{ref:i,className:j?"h-full w-full border-none bg-always-white":"absolute opacity-0 w-0 h-0 overflow-hidden pointer-events-none",content:j?n:void 0,type:j?s:void 0,onSandboxConfirmation:u,capabilities:m,onReportError:N,onSetContent:M,onRefresh:E,externalLinkBehavior:"ask"}),j&&S&&(0,g.jsx)(td,{error:S,sendMessage:h?p:void 0,isStreaming:d})]}),void 0===n||void 0===s?null:s===l.Code||r?(0,g.jsx)(te,{noDefaultScroll:!c,ref:w,className:(0,C.Z)("ease-out duration-200","relative flex w-full flex-1 overflow-x-auto overflow-y-scroll",_&&tR),children:(0,g.jsx)(tq,{content:n,isStreaming:d,language:a,sendMessage:p,isOpen:t},"code-".concat(v,"-").concat(f,"-").concat(c))}):s===l.Markdown?(0,g.jsx)(te,{noDefaultScroll:!c,ref:w,className:(0,C.Z)("ease-out duration-200","relative flex w-full flex-1 overflow-x-auto overflow-y-scroll",_&&tR),children:(0,g.jsx)(tP,{content:n,citations:o,isStreaming:d,sendMessage:p,isOpen:t},"markdown-".concat(v,"-").concat(f,"-").concat(c))}):null]})},tq=e=>{let{content:t,isStreaming:n,language:a,sendMessage:o,isOpen:s}=e,{codeStyle:r}=x();return(0,g.jsx)(ti,{isStreaming:n,sendMessage:o,contentType:"code",isOpen:s,children:(0,g.jsx)(T.Z,{className:"code-block__code !my-0 h-fit min-h-full w-fit min-w-full !rounded-none !text-sm !leading-relaxed",language:a,PreTag:"div",style:r,renderer:A,children:t})})},tP=e=>{let{content:t,citations:n,isStreaming:a,sendMessage:o,isOpen:s}=e,r=eh(),i=(0,k.useMemo)(()=>r&&n&&n.length>0?ee(n,t):t,[t,n,r]);return(0,g.jsx)(ti,{isStreaming:a,sendMessage:o,isOpen:s,children:(0,g.jsxs)("div",{tabIndex:0,id:"markdown-artifact",className:"font-claude-message mx-auto w-full max-w-3xl leading-[1.65rem] -tracking-[0.015em] px-6 pt-4 md:pt-6 md:px-11",children:[(0,g.jsx)(e8,{text:i,blockCitations:n,className:"!gap-3.5"}),(0,g.jsx)("div",{className:"h-8"})]})})},tA=(e,t)=>{if(!e||!t)return -1;let n=e.replace(/\\n/g,"\n"),a=t.replace(/\\n/g,"\n"),o=[...n].findIndex((e,t)=>e!==a[t]);if(-1===o&&n.length===a.length)return -1;let s=(n.slice(0,-1===o?n.length:o).match(/\n/g)||[]).length,r=(n.match(/\n/g)||[]).length;return r?Math.round(s/r*100):-1}}},function(e){e.O(0,[703,764,532,660,276,143,220,65,293,362,856,744],function(){return e(e.s=45380)}),_N_E=e.O()}]);